{{ n >= 1 }}

best = 1;
max = rat(-1);
i = 0;
flag = true;
while (i < n) {
    i = i + 1;
    a[i] ~ lap(e /. rat(2)) +. q[i];
    if ((a[i] > max) | flag) then {
        best = i;
        max = a[i];
    }
    flag = false;
}

{{ for j in [1, i] . q[best] >. q[j] -. (rat(4) /. e) *. log(rat(n) /. beta) }}
{{ beta }}
